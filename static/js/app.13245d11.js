(function(){"use strict";var e={19:function(e,t,a){var o=a(5130),r=a(2261),n=a(6768),l=a(4232);const i={id:"app"},s={key:0,class:"global-loading"},u={key:1,class:"global-error"};function c(e,t,a,r,c,d){const g=(0,n.g2)("SwiftHeader"),v=(0,n.g2)("router-view"),m=(0,n.g2)("SwiftLogin"),f=(0,n.g2)("el-dialog"),p=(0,n.g2)("SwiftRegister"),h=(0,n.g2)("el-loading"),k=(0,n.g2)("el-backtop"),w=(0,n.g2)("NotificationCenter"),b=(0,n.g2)("el-alert");return(0,n.uX)(),(0,n.CE)("div",i,[(0,n.bF)(g,{"is-fixed":r.isHeaderFixed,onShowLogin:r.showLoginModal,onShowRegister:r.showRegisterModal},null,8,["is-fixed","onShowLogin","onShowRegister"]),(0,n.Lk)("main",{class:(0,l.C4)(["app-main",{"with-fixed-header":r.isHeaderFixed}])},[(0,n.bF)(v,null,{default:(0,n.k6)(({Component:e,route:t})=>[(0,n.bF)(o.eB,{name:"page-transition",mode:"out-in"},{default:(0,n.k6)(()=>[((0,n.uX)(),(0,n.Wv)(n.PR,{include:r.cachedPages},[((0,n.uX)(),(0,n.Wv)((0,n.$y)(e),{key:t.path}))],1032,["include"]))]),_:2},1024)]),_:1})],2),(0,n.bF)(f,{modelValue:r.showLogin,"onUpdate:modelValue":t[0]||(t[0]=e=>r.showLogin=e),title:"登录 SwiftShare",width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1},{default:(0,n.k6)(()=>[(0,n.bF)(m,{onLoginSuccess:r.handleLoginSuccess,onSwitchToRegister:r.switchToRegister},null,8,["onLoginSuccess","onSwitchToRegister"])]),_:1},8,["modelValue"]),(0,n.bF)(f,{modelValue:r.showRegister,"onUpdate:modelValue":t[1]||(t[1]=e=>r.showRegister=e),title:"注册 SwiftShare",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1},{default:(0,n.k6)(()=>[(0,n.bF)(p,{onRegisterSuccess:r.handleRegisterSuccess,onSwitchToLogin:r.switchToLogin},null,8,["onRegisterSuccess","onSwitchToLogin"])]),_:1},8,["modelValue"]),r.appStore.loading?((0,n.uX)(),(0,n.CE)("div",s,[(0,n.bF)(h),(0,n.Lk)("p",null,(0,l.v_)(r.appStore.loadingText),1)])):(0,n.Q3)("",!0),(0,n.bF)(k,{right:40,bottom:40,"visibility-height":300}),(0,n.bF)(w),r.appStore.error?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.bF)(b,{title:r.appStore.error.title,description:r.appStore.error.message,type:"error",closable:!0,onClose:r.appStore.clearError,"show-icon":""},null,8,["title","description","onClose"])])):(0,n.Q3)("",!0)])}var d=a(144),g=a(1387);const v={class:"swift-header-container"},m={class:"nav-icon"},f={class:"nav-text"},p={key:0,class:"search-suggestions"},h=["onClick"],k={class:"swift-user"},w={class:"user-avatar"},b={class:"user-name"},S={key:0,class:"mobile-menu"},y={class:"mobile-menu-content"},F={class:"nav-icon"},_={class:"nav-text"};function L(e,t,a,r,i,s){const u=(0,n.g2)("router-link"),c=(0,n.g2)("Search"),d=(0,n.g2)("el-icon"),g=(0,n.g2)("CircleCloseFilled"),L=(0,n.g2)("el-input"),C=(0,n.g2)("el-button"),E=(0,n.g2)("UserFilled"),R=(0,n.g2)("User"),I=(0,n.g2)("el-avatar"),A=(0,n.g2)("el-dropdown-item"),M=(0,n.g2)("Upload"),W=(0,n.g2)("Star"),K=(0,n.g2)("SwitchButton"),x=(0,n.g2)("el-dropdown-menu"),T=(0,n.g2)("el-dropdown");return(0,n.uX)(),(0,n.CE)("div",{class:(0,l.C4)(["swift-header",a.isFixed?"swift-header-fixed":""])},[(0,n.Lk)("div",v,[(0,n.Lk)("div",{class:"swift-logo",onClick:t[0]||(t[0]=(...e)=>r.goHome&&r.goHome(...e))},t[3]||(t[3]=[(0,n.Lk)("div",{class:"logo-icon"},"🎵",-1),(0,n.Lk)("div",{class:"logo-text"},[(0,n.Lk)("span",{class:"logo-title"},"SwiftShare"),(0,n.Lk)("span",{class:"logo-subtitle"},"Taylor Swift Community")],-1)])),(0,n.Lk)("nav",{class:(0,l.C4)(["swift-nav",{"nav-mobile":r.isMobile}])},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.navItems,t=>((0,n.uX)(),(0,n.Wv)(u,{key:t.path,to:t.path,class:(0,l.C4)(["nav-item",{active:e.$route.path===t.path}]),onClick:r.handleNavClick},{default:(0,n.k6)(()=>[(0,n.Lk)("span",m,(0,l.v_)(t.icon),1),(0,n.Lk)("span",f,(0,l.v_)(t.name),1)]),_:2},1032,["to","class","onClick"]))),128))],2),(0,n.Lk)("div",{class:(0,l.C4)(["swift-search",{"search-mobile":r.isMobile}])},[(0,n.bF)(L,{modelValue:r.searchKeyword,"onUpdate:modelValue":t[1]||(t[1]=e=>r.searchKeyword=e),placeholder:"搜索霉霉相关内容...",class:"search-input",onKeyup:(0,o.jR)(r.handleSearch,["enter"]),onFocus:r.handleSearchFocus,onBlur:r.handleSearchBlur},(0,n.eX)({prefix:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(c)]),_:1})]),_:2},[r.searchKeyword?{name:"suffix",fn:(0,n.k6)(()=>[(0,n.bF)(d,{onClick:r.clearSearch,class:"clear-icon"},{default:(0,n.k6)(()=>[(0,n.bF)(g)]),_:1},8,["onClick"])]),key:"0"}:void 0]),1032,["modelValue","onKeyup","onFocus","onBlur"]),r.showSearchSuggestions?((0,n.uX)(),(0,n.CE)("div",p,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.searchSuggestions,e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"suggestion-item",onClick:t=>r.selectSuggestion(e)},[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(c)]),_:1}),(0,n.Lk)("span",null,(0,l.v_)(e.text),1)],8,h))),128))])):(0,n.Q3)("",!0)],2),(0,n.Lk)("div",k,[(0,n.bF)(C,{onClick:r.appStore.toggleTheme,class:"theme-toggle-btn",title:r.appStore.isDarkMode?"切换到浅色模式":"切换到深色模式"},{default:(0,n.k6)(()=>[r.appStore.isDarkMode?((0,n.uX)(),(0,n.Wv)(d,{key:0},{default:(0,n.k6)(()=>t[4]||(t[4]=[(0,n.eW)("☀️",-1)])),_:1,__:[4]})):((0,n.uX)(),(0,n.Wv)(d,{key:1},{default:(0,n.k6)(()=>t[5]||(t[5]=[(0,n.eW)("🌙",-1)])),_:1,__:[5]}))]),_:1},8,["onClick","title"]),r.isLoggedIn?((0,n.uX)(),(0,n.CE)("div",{key:0,class:(0,l.C4)(["role-badge",r.userRole])},[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(E)]),_:1}),(0,n.Lk)("span",null,(0,l.v_)(r.getRoleDisplayName(r.userRole)),1)],2)):(0,n.Q3)("",!0),r.isLoggedIn?((0,n.uX)(),(0,n.Wv)(T,{key:1,onCommand:r.handleUserCommand,trigger:"click"},{dropdown:(0,n.k6)(()=>[(0,n.bF)(x,null,{default:(0,n.k6)(()=>[(0,n.bF)(A,{command:"profile"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(R)]),_:1}),t[6]||(t[6]=(0,n.eW)(" 个人中心 ",-1))]),_:1,__:[6]}),(0,n.bF)(A,{command:"upload"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(M)]),_:1}),t[7]||(t[7]=(0,n.eW)(" 上传内容 ",-1))]),_:1,__:[7]}),(0,n.bF)(A,{command:"favorites"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(W)]),_:1}),t[8]||(t[8]=(0,n.eW)(" 我的收藏 ",-1))]),_:1,__:[8]}),(0,n.bF)(A,{divided:"",command:"logout"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(K)]),_:1}),t[9]||(t[9]=(0,n.eW)(" 退出登录 ",-1))]),_:1,__:[9]})]),_:1})]),default:(0,n.k6)(()=>[(0,n.Lk)("div",w,[(0,n.bF)(I,{src:r.userAvatar,size:32},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(R)]),_:1})]),_:1},8,["src"]),(0,n.Lk)("span",b,(0,l.v_)(r.userName),1)])]),_:1},8,["onCommand"])):((0,n.uX)(),(0,n.CE)(n.FK,{key:2},[(0,n.bF)(C,{type:"primary",onClick:r.showLogin,class:"login-btn"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(R)]),_:1}),t[10]||(t[10]=(0,n.eW)(" 登录 ",-1))]),_:1,__:[10]},8,["onClick"]),(0,n.bF)(C,{onClick:r.showRegister,class:"register-btn"},{default:(0,n.k6)(()=>t[11]||(t[11]=[(0,n.eW)(" 注册 ",-1)])),_:1,__:[11]},8,["onClick"])],64))]),r.isMobile?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"mobile-menu-btn",onClick:t[2]||(t[2]=(...e)=>r.toggleMobileMenu&&r.toggleMobileMenu(...e))},[(0,n.Lk)("span",{class:(0,l.C4)({active:r.isMobileMenuOpen})},null,2),(0,n.Lk)("span",{class:(0,l.C4)({active:r.isMobileMenuOpen})},null,2),(0,n.Lk)("span",{class:(0,l.C4)({active:r.isMobileMenuOpen})},null,2)])):(0,n.Q3)("",!0)]),r.isMobile&&r.isMobileMenuOpen?((0,n.uX)(),(0,n.CE)("div",S,[(0,n.Lk)("div",y,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.navItems,e=>((0,n.uX)(),(0,n.Wv)(u,{key:e.path,to:e.path,class:"mobile-nav-item",onClick:r.closeMobileMenu},{default:(0,n.k6)(()=>[(0,n.Lk)("span",F,(0,l.v_)(e.icon),1),(0,n.Lk)("span",_,(0,l.v_)(e.name),1)]),_:2},1032,["to","onClick"]))),128))])])):(0,n.Q3)("",!0)],2)}a(4114),a(8111),a(1701);var C=a(7477),E=a(1570),R=a(8105),I=a(1219),A={name:"SwiftHeader",components:{Search:C.Search,User:C.User,Upload:C.Upload,Star:C.Star,SwitchButton:C.SwitchButton,CircleCloseFilled:C.CircleCloseFilled,UserFilled:C.UserFilled},props:{isFixed:{type:Boolean,default:!1}},emits:["show-login","show-register"],setup(e,{emit:t}){const a=(0,g.rd)(),o=(0,E.kH)(),r=(0,R.useAppStore)(),l=(0,d.KR)(""),i=(0,d.KR)(!1),s=(0,d.KR)(!1),u=(0,d.KR)(!1),c=(0,n.EW)(()=>o.isLoggedIn),v=(0,n.EW)(()=>o.userInfo?.avatar||""),m=(0,n.EW)(()=>o.userInfo?.username||""),f=(0,n.EW)(()=>o.userInfo?.role||"user"),p=[{name:"首页",path:"/",icon:"🏠"},{name:"音乐库",path:"/music",icon:"🎵"},{name:"视频库",path:"/videos",icon:"🎬"},{name:"社区",path:"/community",icon:"💕"},{name:"资讯",path:"/news",icon:"📰"}],h=(0,n.EW)(()=>{if(!l.value)return[];const e=["Taylor Swift Eras Tour","Midnights Album","Folklore Live","Swiftie Community","Taylor Swift News","Reputation Stadium Tour","Lover Album","1989 World Tour"];return e.filter(e=>e.toLowerCase().includes(l.value.toLowerCase())).slice(0,5).map((e,t)=>({id:t,text:e}))}),k=()=>{a.push("/")},w=()=>{u.value&&K()},b=()=>{l.value.trim()&&(a.push({path:"/search",query:{keyword:l.value}}),i.value=!1)},S=()=>{l.value&&(i.value=!0)},y=()=>{setTimeout(()=>{i.value=!1},200)},F=()=>{l.value="",i.value=!1},_=e=>{l.value=e.text,b()},L=e=>{switch(e){case"profile":a.push("/profile");break;case"upload":a.push("/upload");break;case"favorites":a.push("/profile?tab=favorites");break;case"logout":M();break}},C=()=>{t("show-login")},A=()=>{t("show-register")},M=()=>{o.logout(),a.push("/"),I.nk.success("已退出登录")},W=()=>{s.value=!s.value},K=()=>{s.value=!1},x=e=>{switch(e){case"admin":return"管理员";case"moderator":return"版主";default:return"用户"}},T=()=>{u.value=window.innerWidth<=768};return(0,n.sV)(()=>{T(),window.addEventListener("resize",T)}),(0,n.hi)(()=>{window.removeEventListener("resize",T)}),{searchKeyword:l,showSearchSuggestions:i,isMobileMenuOpen:s,isMobile:u,isLoggedIn:c,userAvatar:v,userName:m,navItems:p,searchSuggestions:h,goHome:k,handleNavClick:w,handleSearch:b,handleSearchFocus:S,handleSearchBlur:y,clearSearch:F,selectSuggestion:_,handleUserCommand:L,showLogin:C,showRegister:A,logout:M,toggleMobileMenu:W,closeMobileMenu:K,userRole:f,getRoleDisplayName:x,appStore:r}}},M=a(1241);const W=(0,M.A)(A,[["render",L],["__scopeId","data-v-ca660520"]]);var K=W,x=a(2108),T=a(3224);const U={class:"notification-center"},N={class:"notification-icon"},V={class:"notification-content"},P={class:"notification-message"},O={class:"notification-time"},q=["onClick"];function X(e,t,a,r,i,s){const u=(0,n.g2)("CircleCheckFilled"),c=(0,n.g2)("el-icon"),d=(0,n.g2)("CircleCloseFilled"),g=(0,n.g2)("WarningFilled"),v=(0,n.g2)("InfoFilled"),m=(0,n.g2)("Close");return(0,n.uX)(),(0,n.CE)("div",U,[(0,n.bF)(o.F,{name:"notification",tag:"div",class:"notification-list"},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.notifications,e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:(0,l.C4)(["notification-item",e.type])},[(0,n.Lk)("div",N,["success"===e.type?((0,n.uX)(),(0,n.Wv)(c,{key:0},{default:(0,n.k6)(()=>[(0,n.bF)(u)]),_:1})):"error"===e.type?((0,n.uX)(),(0,n.Wv)(c,{key:1},{default:(0,n.k6)(()=>[(0,n.bF)(d)]),_:1})):"warning"===e.type?((0,n.uX)(),(0,n.Wv)(c,{key:2},{default:(0,n.k6)(()=>[(0,n.bF)(g)]),_:1})):((0,n.uX)(),(0,n.Wv)(c,{key:3},{default:(0,n.k6)(()=>[(0,n.bF)(v)]),_:1}))]),(0,n.Lk)("div",V,[(0,n.Lk)("div",P,(0,l.v_)(e.message),1),(0,n.Lk)("div",O,(0,l.v_)(r.formatTime(e.timestamp)),1)]),(0,n.Lk)("div",{class:"notification-close",onClick:t=>r.removeNotification(e.id)},[(0,n.bF)(c,null,{default:(0,n.k6)(()=>[(0,n.bF)(m)]),_:1})],8,q)],2))),128))]),_:1})])}var D={name:"NotificationCenter",components:{CircleCheckFilled:C.CircleCheckFilled,CircleCloseFilled:C.CircleCloseFilled,WarningFilled:C.WarningFilled,InfoFilled:C.InfoFilled,Close:C.Close},setup(){const e=(0,E.CU)(),t=(0,n.EW)(()=>e.notifications),a=t=>{e.removeNotification(t)},o=e=>{const t=new Date,a=new Date(e),o=t-a;return o<6e4?"刚刚":o<36e5?`${Math.floor(o/6e4)}分钟前`:o<864e5?`${Math.floor(o/36e5)}小时前`:a.toLocaleDateString()};return{notifications:t,removeNotification:a,formatTime:o}}};const H=(0,M.A)(D,[["render",X],["__scopeId","data-v-351c24d0"]]);var j=H,z={name:"App",components:{SwiftHeader:K,SwiftLogin:x["default"],SwiftRegister:T["default"],NotificationCenter:j},setup(){const e=(0,g.lq)(),t=(0,E.CU)(),a=(0,E.kH)(),o=(0,d.KR)(!1),r=(0,d.KR)(!1),l=(0,d.KR)(!1),i=(0,d.KR)(0),s=(0,n.EW)(()=>{const t=["SwiftHome","SwiftMusic","SwiftVideos","SwiftCommunity","SwiftNews"];return t.filter(()=>e.meta?.keepAlive)}),u=()=>{o.value=!0},c=()=>{r.value=!0},v=()=>{o.value=!1,I.nk.success("登录成功！欢迎回到 SwiftShare")},m=()=>{r.value=!1,o.value=!0,I.nk.success("注册成功！请登录您的账户")},f=()=>{o.value=!1,r.value=!0},p=()=>{r.value=!1,o.value=!0},h=()=>{i.value=window.scrollY,l.value=i.value>100};return(0,n.sV)(()=>{window.addEventListener("scroll",h)}),(0,n.hi)(()=>{window.removeEventListener("scroll",h)}),{appStore:t,userStore:a,showLogin:o,showRegister:r,isHeaderFixed:l,cachedPages:s,showLoginModal:u,showRegisterModal:c,handleLoginSuccess:v,handleRegisterSuccess:m,switchToRegister:f,switchToLogin:p}}};const B=(0,M.A)(z,[["render",c]]);var J=B,$=a(7425),Q=(a(4188),a(5186)),Y=a(4373),G=a(5003);const Z=()=>Promise.all([a.e(620),a.e(173)]).then(a.bind(a,5438)),ee=()=>Promise.all([a.e(620),a.e(295)]).then(a.bind(a,6948)),te=()=>a.e(794).then(a.bind(a,8794)),ae=()=>a.e(705).then(a.bind(a,9705)),oe=()=>a.e(790).then(a.bind(a,1790)),re=()=>a.e(728).then(a.bind(a,728)),ne=()=>a.e(52).then(a.bind(a,5052)),le=()=>a.e(925).then(a.bind(a,1925)),ie=()=>a.e(84).then(a.bind(a,5084)),se=()=>Promise.resolve().then(a.bind(a,2108)),ue=()=>Promise.resolve().then(a.bind(a,3224)),ce=[{path:"/",name:"swift-home",component:Z,meta:{title:"SwiftShare - 霉霉粉丝社区",requestAuth:!1,keepAlive:!0,analytics:!0,description:"欢迎来到霉霉粉丝社区"}},{path:"/music",name:"swift-music",component:ee,meta:{title:"音乐库 - SwiftShare",requestAuth:!1,keepAlive:!0,analytics:!0,description:"探索霉霉的所有音乐作品"}},{path:"/videos",name:"swift-videos",component:te,meta:{title:"视频库 - SwiftShare",requestAuth:!1,keepAlive:!0,analytics:!0,description:"观看MV、演唱会、采访等精彩视频"}},{path:"/community",name:"swift-community",component:ae,meta:{title:"Swiftie社区 - SwiftShare",requestAuth:!1,keepAlive:!0,analytics:!0,description:"与其他Swiftie交流分享"}},{path:"/news",name:"swift-news",component:oe,meta:{title:"霉霉资讯 - SwiftShare",requestAuth:!1,keepAlive:!0,analytics:!0,description:"获取霉霉最新动态和资讯"}},{path:"/profile",name:"swift-profile",component:re,meta:{title:"个人中心 - SwiftShare",requestAuth:!0,keepAlive:!1,analytics:!0,description:"管理个人信息和设置",roles:["user","admin"]}},{path:"/upload",name:"swift-upload",component:ne,meta:{title:"上传内容 - SwiftShare",requestAuth:!0,keepAlive:!1,analytics:!0,description:"上传音乐、视频等内容",roles:["user","admin"]}},{path:"/detail/:id",name:"swift-detail",component:le,meta:{title:"内容详情 - SwiftShare",requestAuth:!1,keepAlive:!1,analytics:!0,description:"查看内容详细信息"},props:!0},{path:"/search",name:"swift-search",component:ie,meta:{title:"搜索 - SwiftShare",requestAuth:!1,keepAlive:!1,analytics:!0,description:"搜索霉霉相关内容"},props:e=>({keyword:e.query.keyword,type:e.query.type||"all"})},{path:"/login",name:"swift-login",component:se,meta:{title:"登录 - SwiftShare",requestAuth:!1,keepAlive:!1,analytics:!1,description:"登录到SwiftShare"}},{path:"/register",name:"swift-register",component:ue,meta:{title:"注册 - SwiftShare",requestAuth:!1,keepAlive:!1,analytics:!1,description:"注册SwiftShare账号"}}];var de=ce;const ge=()=>a.e(31).then(a.bind(a,6031)),ve=[...de,{path:"/:catchAll(.*)",name:"notfound",component:ge,meta:{requestAuth:!1}}],me=(0,g.aE)({history:(0,g.LA)(),routes:ve});me.beforeEach(async(e,t,a)=>{const o=(0,G.useUserStore)(),r=(0,R.useAppStore)();r.showLoading("页面加载中...");try{if(e.meta.title&&(document.title=e.meta.title),e.meta.requestAuth){if(!o.isLoggedIn&&(await o.initUserState(),!o.isLoggedIn))return void a({name:"swift-login",query:{redirect:e.fullPath}});if(!o.userInfo)try{await o.fetchUserInfo()}catch(n){return o.logout(),void a({name:"swift-login",query:{redirect:e.fullPath}})}}if(e.meta.roles&&e.meta.roles.length>0){const t=o.userInfo?.role||"user";if(!e.meta.roles.includes(t))return void a({name:"notfound"})}a()}catch(n){console.error("路由守卫错误:",n),a({name:"notfound"})}finally{r.hideLoading()}}),me.afterEach((e,t)=>{console.log(`页面跳转: ${t.path} -> ${e.path}`),e.meta.analytics}),me.onError(e=>{console.error("路由错误:",e);const t=(0,R.useAppStore)();t.hideLoading()});var fe=me;const pe=(0,o.Ef)(J),he=(0,r.Ey)();pe.config.globalProperties.$axios=Y.A,pe.use($.A,{locale:Q.A});for(const[ke,we]of Object.entries(C))pe.component(ke,we);pe.use(he),pe.use(fe),(0,E.Xr)(),pe.mount("#app")},1570:function(e,t,a){a.d(t,{CU:function(){return r.useAppStore},Xr:function(){return n},kH:function(){return o.useUserStore}});var o=a(5003),r=(a(4641),a(4782),a(8105));const n=()=>{const{useAppStore:e}=a(8105),{useUserStore:t}=a(5003),{useVideoStore:o}=a(4782),r=e(),n=t(),l=o();r.init(),n.initUserState(),l.init(),console.log("所有状态管理已初始化")}},2108:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var o=a(6768),r=a(5130),n=a(4232);const l={class:"swift-login"},i={class:"login-form"},s={class:"login-options"},u={class:"social-login"},c={class:"login-footer"};function d(e,t,a,d,g,v){const m=(0,o.g2)("el-input"),f=(0,o.g2)("el-form-item"),p=(0,o.g2)("el-checkbox"),h=(0,o.g2)("el-link"),k=(0,o.g2)("el-button"),w=(0,o.g2)("el-form"),b=(0,o.g2)("ChatDotRound"),S=(0,o.g2)("el-icon"),y=(0,o.g2)("Message");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",i,[t[9]||(t[9]=(0,o.Lk)("div",{class:"login-header"},[(0,o.Lk)("div",{class:"login-icon"},"🎵"),(0,o.Lk)("h2",{class:"login-title"},"欢迎回到 SwiftShare"),(0,o.Lk)("p",{class:"login-subtitle"},"登录你的霉霉粉丝账户")],-1)),(0,o.bF)(w,{ref:"loginFormRef",model:d.loginForm,rules:d.loginRules,class:"login-form-content",onSubmit:(0,r.D$)(d.handleLogin,["prevent"])},{default:(0,o.k6)(()=>[(0,o.bF)(f,{prop:"username"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.loginForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>d.loginForm.username=e),placeholder:"用户名或邮箱",size:"large","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(f,{prop:"password"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=e=>d.loginForm.password=e),type:"password",placeholder:"密码",size:"large","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.Lk)("div",s,[(0,o.bF)(p,{modelValue:d.rememberMe,"onUpdate:modelValue":t[2]||(t[2]=e=>d.rememberMe=e)},{default:(0,o.k6)(()=>t[3]||(t[3]=[(0,o.eW)("记住我",-1)])),_:1,__:[3]},8,["modelValue"]),(0,o.bF)(h,{type:"primary",underline:!1},{default:(0,o.k6)(()=>t[4]||(t[4]=[(0,o.eW)("忘记密码？",-1)])),_:1,__:[4]})]),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(k,{type:"primary",size:"large",class:"login-btn",loading:d.isLoading,onClick:d.handleLogin},{default:(0,o.k6)(()=>[(0,o.eW)((0,n.v_)(d.isLoading?"登录中...":"登录"),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules","onSubmit"]),t[10]||(t[10]=(0,o.Lk)("div",{class:"login-divider"},[(0,o.Lk)("span",null,"或者")],-1)),(0,o.Lk)("div",u,[(0,o.bF)(k,{class:"social-btn wechat"},{default:(0,o.k6)(()=>[(0,o.bF)(S,null,{default:(0,o.k6)(()=>[(0,o.bF)(b)]),_:1}),t[5]||(t[5]=(0,o.eW)(" 微信登录 ",-1))]),_:1,__:[5]}),(0,o.bF)(k,{class:"social-btn qq"},{default:(0,o.k6)(()=>[(0,o.bF)(S,null,{default:(0,o.k6)(()=>[(0,o.bF)(y)]),_:1}),t[6]||(t[6]=(0,o.eW)(" QQ登录 ",-1))]),_:1,__:[6]})]),(0,o.Lk)("div",c,[(0,o.Lk)("p",null,[t[8]||(t[8]=(0,o.eW)("还没有账户？ ",-1)),(0,o.bF)(h,{type:"primary",underline:!1,onClick:d.goToRegister},{default:(0,o.k6)(()=>t[7]||(t[7]=[(0,o.eW)(" 立即注册 ",-1)])),_:1,__:[7]},8,["onClick"])])])])])}var g=a(144),v=a(7477),m=a(5003),f={name:"SwiftLogin",components:{ChatDotRound:v.ChatDotRound,Message:v.Message},emits:["login-success","switch-to-register"],setup(e,{emit:t}){const a=(0,m.useUserStore)(),o=(0,g.KR)(null),r=(0,g.KR)(!1),n=(0,g.Kh)({username:"",password:""}),l={username:[{required:!0,message:"请输入用户名或邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}]},i=async()=>{if(o.value)try{await o.value.validate();const e=await a.login(n);e.success&&t("login-success")}catch(e){console.error("登录验证失败:",e)}},s=()=>{t("switch-to-register")};return{loginFormRef:o,loginForm:n,loginRules:l,rememberMe:r,isLoading:a.loading,handleLogin:i,goToRegister:s}}},p=a(1241);const h=(0,p.A)(f,[["render",d],["__scopeId","data-v-14467042"]]);var k=h},3224:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var o=a(6768),r=a(5130),n=a(4232);const l={class:"swift-register"},i={class:"register-form"},s={class:"register-options"},u={class:"social-register"},c={class:"register-footer"};function d(e,t,a,d,g,v){const m=(0,o.g2)("el-input"),f=(0,o.g2)("el-form-item"),p=(0,o.g2)("el-link"),h=(0,o.g2)("el-checkbox"),k=(0,o.g2)("el-button"),w=(0,o.g2)("el-form"),b=(0,o.g2)("ChatDotRound"),S=(0,o.g2)("el-icon"),y=(0,o.g2)("Message");return(0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",i,[t[14]||(t[14]=(0,o.Lk)("div",{class:"register-header"},[(0,o.Lk)("div",{class:"register-icon"},"🎵"),(0,o.Lk)("h2",{class:"register-title"},"加入 SwiftShare"),(0,o.Lk)("p",{class:"register-subtitle"},"成为霉霉粉丝社区的一员")],-1)),(0,o.bF)(w,{ref:"registerFormRef",model:d.registerForm,rules:d.registerRules,class:"register-form-content",onSubmit:(0,r.D$)(d.handleRegister,["prevent"])},{default:(0,o.k6)(()=>[(0,o.bF)(f,{prop:"username"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.registerForm.username,"onUpdate:modelValue":t[0]||(t[0]=e=>d.registerForm.username=e),placeholder:"用户名",size:"large","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(f,{prop:"nickname"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.registerForm.nickname,"onUpdate:modelValue":t[1]||(t[1]=e=>d.registerForm.nickname=e),placeholder:"昵称",size:"large","prefix-icon":"UserFilled",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(f,{prop:"email"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.registerForm.email,"onUpdate:modelValue":t[2]||(t[2]=e=>d.registerForm.email=e),placeholder:"邮箱",size:"large","prefix-icon":"Message",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(f,{prop:"password"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.registerForm.password,"onUpdate:modelValue":t[3]||(t[3]=e=>d.registerForm.password=e),type:"password",placeholder:"密码",size:"large","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.bF)(f,{prop:"confirmPassword"},{default:(0,o.k6)(()=>[(0,o.bF)(m,{modelValue:d.registerForm.confirmPassword,"onUpdate:modelValue":t[4]||(t[4]=e=>d.registerForm.confirmPassword=e),type:"password",placeholder:"确认密码",size:"large","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),(0,o.Lk)("div",s,[(0,o.bF)(h,{modelValue:d.agreeTerms,"onUpdate:modelValue":t[5]||(t[5]=e=>d.agreeTerms=e)},{default:(0,o.k6)(()=>[t[8]||(t[8]=(0,o.eW)(" 我已阅读并同意 ",-1)),(0,o.bF)(p,{type:"primary",underline:!1},{default:(0,o.k6)(()=>t[6]||(t[6]=[(0,o.eW)("用户协议",-1)])),_:1,__:[6]}),t[9]||(t[9]=(0,o.eW)(" 和 ",-1)),(0,o.bF)(p,{type:"primary",underline:!1},{default:(0,o.k6)(()=>t[7]||(t[7]=[(0,o.eW)("隐私政策",-1)])),_:1,__:[7]})]),_:1,__:[8,9]},8,["modelValue"])]),(0,o.bF)(f,null,{default:(0,o.k6)(()=>[(0,o.bF)(k,{type:"primary",size:"large",class:"register-btn",loading:d.isLoading,onClick:d.handleRegister},{default:(0,o.k6)(()=>[(0,o.eW)((0,n.v_)(d.isLoading?"注册中...":"立即注册"),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules","onSubmit"]),t[15]||(t[15]=(0,o.Lk)("div",{class:"register-divider"},[(0,o.Lk)("span",null,"或者")],-1)),(0,o.Lk)("div",u,[(0,o.bF)(k,{class:"social-btn wechat"},{default:(0,o.k6)(()=>[(0,o.bF)(S,null,{default:(0,o.k6)(()=>[(0,o.bF)(b)]),_:1}),t[10]||(t[10]=(0,o.eW)(" 微信注册 ",-1))]),_:1,__:[10]}),(0,o.bF)(k,{class:"social-btn qq"},{default:(0,o.k6)(()=>[(0,o.bF)(S,null,{default:(0,o.k6)(()=>[(0,o.bF)(y)]),_:1}),t[11]||(t[11]=(0,o.eW)(" QQ注册 ",-1))]),_:1,__:[11]})]),(0,o.Lk)("div",c,[(0,o.Lk)("p",null,[t[13]||(t[13]=(0,o.eW)("已有账户？ ",-1)),(0,o.bF)(p,{type:"primary",underline:!1,onClick:d.goToLogin},{default:(0,o.k6)(()=>t[12]||(t[12]=[(0,o.eW)(" 立即登录 ",-1)])),_:1,__:[12]},8,["onClick"])])])])])}var g=a(144),v=a(7477),m=a(1219),f=a(5003),p={name:"SwiftRegister",components:{ChatDotRound:v.ChatDotRound,Message:v.Message},emits:["register-success","switch-to-login"],setup(e,{emit:t}){const a=(0,f.useUserStore)(),o=(0,g.KR)(null),r=(0,g.KR)(!1),n=(0,g.Kh)({username:"EveKoo",email:"123@qq.com",password:"123456",confirmPassword:"123456",nickname:"xiaoyu"}),l={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在3到20个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(e,t,a)=>{t!==n.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"昵称长度在2到20个字符",trigger:"blur"}]},i=async()=>{if(o.value)if(r.value)try{await o.value.validate();const e=await a.register(n);e.success&&t("register-success")}catch(e){console.error("注册验证失败:",e)}else m.nk.warning("请先同意用户协议和隐私政策")},s=()=>{t("switch-to-login")};return{registerFormRef:o,registerForm:n,registerRules:l,agreeTerms:r,isLoading:a.loading,handleRegister:i,goToLogin:s}}},h=a(1241);const k=(0,h.A)(p,[["render",d],["__scopeId","data-v-283f4eae"]]);var w=k},4641:function(e,t,a){a.r(t),a.d(t,{useMusicStore:function(){return i}});a(4114),a(8111),a(116);var o=a(2261),r=a(6768),n=a(144),l=a(1219);const i=(0,o.nY)("music",()=>{const e=(0,n.KR)(null),t=(0,n.KR)([]),a=(0,n.KR)(!1),o=(0,n.KR)(0),i=(0,n.KR)(0),s=(0,n.KR)(.7),u=(0,n.KR)(!1),c=(0,n.KR)("sequence"),d=(0,n.KR)(null),g=(0,r.EW)(()=>e.value&&0!==t.value.length?t.value.findIndex(t=>t.id===e.value.id):-1),v=(0,r.EW)(()=>0!==t.value.length&&("loop"===c.value||g.value<t.value.length-1)),m=(0,r.EW)(()=>0!==t.value.length&&("loop"===c.value||g.value>0)),f=(0,r.EW)(()=>0===i.value?0:o.value/i.value*100),p=(o=null)=>{o&&(e.value=o,t.value.find(e=>e.id===o.id)||t.value.push(o)),d.value&&(d.value.play(),a.value=!0)},h=()=>{d.value&&(d.value.pause(),a.value=!1)},k=()=>{a.value?h():p()},w=()=>{if(0===t.value.length)return;let e;if("random"===c.value)e=Math.floor(Math.random()*t.value.length);else if(e=g.value+1,e>=t.value.length){if("loop"!==c.value)return;e=0}p(t.value[e])},b=()=>{if(0===t.value.length)return;let e;if("random"===c.value)e=Math.floor(Math.random()*t.value.length);else if(e=g.value-1,e<0){if("loop"!==c.value)return;e=t.value.length-1}p(t.value[e])},S=e=>{d.value&&(d.value.currentTime=e,o.value=e)},y=e=>{s.value=e,d.value&&(d.value.volume=e)},F=()=>{u.value=!u.value,d.value&&(d.value.muted=u.value)},_=e=>{c.value=e,l.nk.success(`播放模式：${L(e)}`)},L=e=>{const t={sequence:"顺序播放",loop:"循环播放",random:"随机播放"};return t[e]||"顺序播放"},C=a=>{t.value=a,a.length>0&&!e.value&&p(a[0])},E=e=>{t.value.find(t=>t.id===e.id)?l.nk.info("歌曲已在播放列表中"):(t.value.push(e),l.nk.success("已添加到播放列表"))},R=e=>{const a=t.value.findIndex(t=>t.id===e);a>-1&&(t.value.splice(a,1),l.nk.success("已从播放列表移除"))},I=()=>{t.value=[],e.value=null,a.value=!1,o.value=0,i.value=0,l.nk.success("播放列表已清空")},A=e=>{o.value=e.target.currentTime},M=e=>{i.value=e.target.duration},W=()=>{"loop"===c.value||v.value?w():(a.value=!1,o.value=0,l.nk.info("播放完成"))},K=e=>{l.nk.error("播放出错，请检查音频文件"),console.error("Audio error:",e)},x=e=>{d.value=e,e&&(e.addEventListener("timeupdate",A),e.addEventListener("loadedmetadata",M),e.addEventListener("ended",W),e.addEventListener("error",K),e.volume=s.value)},T=()=>{d.value&&(d.value.removeEventListener("timeupdate",A),d.value.removeEventListener("loadedmetadata",M),d.value.removeEventListener("ended",W),d.value.removeEventListener("error",K),d.value=null)};return{currentSong:e,playlist:t,isPlaying:a,currentTime:o,duration:i,volume:s,isMuted:u,playMode:c,audioElement:d,currentIndex:g,hasNext:v,hasPrev:m,progress:f,play:p,pause:h,togglePlay:k,next:w,prev:b,seek:S,setVolume:y,toggleMute:F,setPlayMode:_,getPlayModeText:L,setPlaylist:C,addToPlaylist:E,removeFromPlaylist:R,clearPlaylist:I,initAudioElement:x,cleanup:T}})},4782:function(e,t,a){a.r(t),a.d(t,{useVideoStore:function(){return i}});a(4114),a(8111),a(3579);var o=a(2261),r=a(6768),n=a(144),l=a(1219);const i=(0,o.nY)("video",()=>{const e=(0,n.KR)(null),t=(0,n.KR)(!1),a=(0,n.KR)(0),o=(0,n.KR)(0),i=(0,n.KR)(.7),s=(0,n.KR)(!1),u=(0,n.KR)(!1),c=(0,n.KR)(1),d=(0,n.KR)([]),g=(0,n.KR)([]),v=(0,n.KR)(null),m=(0,r.EW)(()=>0===o.value?0:a.value/o.value*100),f=(0,r.EW)(()=>!!e.value&&g.value.some(t=>t.id===e.value.id)),p=(0,r.EW)(()=>d.value.length),h=(0,r.EW)(()=>g.value.length),k=(a=null)=>{a&&(e.value=a,C(a)),v.value&&(v.value.play(),t.value=!0)},w=()=>{v.value&&(v.value.pause(),t.value=!1)},b=()=>{t.value?w():k()},S=e=>{v.value&&(v.value.currentTime=e,a.value=e)},y=e=>{i.value=e,v.value&&(v.value.volume=e)},F=()=>{s.value=!s.value,v.value&&(v.value.muted=s.value)},_=e=>{c.value=e,v.value&&(v.value.playbackRate=e),l.nk.success(`播放速度：${e}x`)},L=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),u.value=!1):v.value?.requestFullscreen&&(v.value.requestFullscreen(),u.value=!0)},C=e=>{const t=d.value.findIndex(t=>t.id===e.id);t>-1&&d.value.splice(t,1),d.value.unshift({...e,watchTime:(new Date).toISOString()}),d.value.length>50&&(d.value=d.value.slice(0,50)),I()},E=e=>{const t=d.value.findIndex(t=>t.id===e);t>-1&&(d.value.splice(t,1),I(),l.nk.success("已从历史记录移除"))},R=()=>{d.value=[],I(),l.nk.success("历史记录已清空")},I=()=>{try{localStorage.setItem("videoHistory",JSON.stringify(d.value))}catch(e){console.error("保存历史记录失败:",e)}},A=()=>{try{const e=localStorage.getItem("videoHistory");e&&(d.value=JSON.parse(e))}catch(e){console.error("加载历史记录失败:",e)}},M=e=>{const t=g.value.findIndex(t=>t.id===e.id);t>-1?(g.value.splice(t,1),l.nk.success("已取消收藏")):(g.value.push({...e,favoriteTime:(new Date).toISOString()}),l.nk.success("已添加到收藏")),x()},W=e=>{const t=g.value.findIndex(t=>t.id===e);t>-1&&(g.value.splice(t,1),x(),l.nk.success("已从收藏移除"))},K=()=>{g.value=[],x(),l.nk.success("收藏已清空")},x=()=>{try{localStorage.setItem("videoFavorites",JSON.stringify(g.value))}catch(e){console.error("保存收藏失败:",e)}},T=()=>{try{const e=localStorage.getItem("videoFavorites");e&&(g.value=JSON.parse(e))}catch(e){console.error("加载收藏失败:",e)}},U=e=>{a.value=e.target.currentTime},N=e=>{o.value=e.target.duration},V=()=>{t.value=!1,a.value=0,l.nk.info("视频播放完成")},P=e=>{l.nk.error("视频播放出错，请检查视频文件"),console.error("Video error:",e)},O=()=>{u.value=!!document.fullscreenElement},q=e=>{v.value=e,e&&(e.addEventListener("timeupdate",U),e.addEventListener("loadedmetadata",N),e.addEventListener("ended",V),e.addEventListener("error",P),document.addEventListener("fullscreenchange",O),e.volume=i.value,e.playbackRate=c.value)},X=()=>{v.value&&(v.value.removeEventListener("timeupdate",U),v.value.removeEventListener("loadedmetadata",N),v.value.removeEventListener("ended",V),v.value.removeEventListener("error",P),document.removeEventListener("fullscreenchange",O),v.value=null)},D=()=>{A(),T()};return{currentVideo:e,isPlaying:t,currentTime:a,duration:o,volume:i,isMuted:s,isFullscreen:u,playbackRate:c,videoHistory:d,favorites:g,videoElement:v,progress:m,isFavorite:f,historyCount:p,favoritesCount:h,play:k,pause:w,togglePlay:b,seek:S,setVolume:y,toggleMute:F,setPlaybackRate:_,toggleFullscreen:L,addToHistory:C,removeFromHistory:E,clearHistory:R,saveHistoryToStorage:I,loadHistoryFromStorage:A,toggleFavorite:M,removeFromFavorites:W,clearFavorites:K,saveFavoritesToStorage:x,loadFavoritesFromStorage:T,initVideoElement:q,cleanup:X,init:D}})},5003:function(e,t,a){a.r(t),a.d(t,{useUserStore:function(){return g}});a(4114),a(8111),a(116);var o=a(2261),r=a(144),n=a(6768),l=a(1219),i=a(4373);const s=!1,u=i.A.create({baseURL:{NODE_ENV:"production",BASE_URL:"/swift-share/"}.VUE_APP_API_URL||"http://localhost:8080/api",timeout:1e4,headers:{"Content-Type":"application/json"}});u.interceptors.request.use(e=>{console.log("发送请求:",e.method.toUpperCase(),e.url);const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("请求错误:",e),Promise.reject(e))),u.interceptors.response.use(e=>{console.log("收到响应:",e.config.url,e.data);const{code:t,message:a,data:o}=e.data;return 200===t||void 0===t?o||e.data:(l.nk.error(a||"请求失败"),Promise.reject(new Error(a||"请求失败")))},e=>{if(console.error("响应错误:",e),e.response){const{status:t,data:a}=e.response;switch(t){case 401:l.nk.error("未授权，请重新登录"),localStorage.removeItem("token"),window.location.href="/login";break;case 403:l.nk.error("权限不足");break;case 404:l.nk.error("请求的资源不存在");break;case 500:l.nk.error("服务器内部错误");break;default:l.nk.error(a.message||"请求失败")}}else e.request?s?l.nk.error("网络错误，请检查网络连接"):console.warn("网络连接失败，将使用模拟功能"):l.nk.error("请求配置错误");return Promise.reject(e)});var c=u;const d={login(e){return c({url:"/user/login",method:"post",data:e})},register(e){return c({url:"/user/register",method:"post",data:e})},getUserInfo(){return c({url:"/user/info",method:"get"})},updateUserInfo(e){return c({url:"/user/info",method:"put",data:e})}},g=(0,o.nY)("user",()=>{const e=(0,r.KR)(null),t=(0,r.KR)(localStorage.getItem("token")||null),a=(0,r.KR)(!!t.value),o=(0,r.KR)(!1),i=(0,n.EW)(()=>e.value?.username||""),s=(0,n.EW)(()=>e.value?.avatar||"/images/default-avatar.jpg"),u=(0,n.EW)(()=>e.value?.id||null),c=async r=>{o.value=!0;try{const o=await d.login(r),{token:n,user:i}=o;return t.value=n,e.value=i,a.value=!0,localStorage.setItem("token",n),localStorage.setItem("userInfo",JSON.stringify(i)),l.nk.success("登录成功"),{success:!0}}catch(n){console.warn("API登录失败，使用模拟登录:",n);try{const e=await g(r);return e.success&&l.nk.success("模拟登录成功"),e}catch(i){return l.nk.error("登录失败，请检查用户名和密码"),{success:!1,error:i}}}finally{o.value=!1}},g=async o=>{await new Promise(e=>setTimeout(e,800));const r=JSON.parse(localStorage.getItem("simulatedUsers")||"[]"),n=r.find(e=>e.username===o.username||e.email===o.username);if(!n)throw new Error("用户不存在");if("123456"!==o.password)throw new Error("密码错误");const l=`mock_token_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return t.value=l,e.value=n,a.value=!0,localStorage.setItem("token",l),localStorage.setItem("userInfo",JSON.stringify(n)),{success:!0}},v=async e=>{o.value=!0;try{return await d.register(e),l.nk.success("注册成功！请登录"),{success:!0}}catch(t){console.warn("API注册失败，使用模拟注册:",t);try{return await m(e),l.nk.success("模拟注册成功！请登录"),{success:!0}}catch(a){return l.nk.error("注册失败，请重试"),{success:!1,error:a}}}finally{o.value=!1}},m=async e=>{await new Promise(e=>setTimeout(e,1e3));const t=JSON.parse(localStorage.getItem("simulatedUsers")||"[]"),a=t.find(t=>t.username===e.username||t.email===e.email);if(a)throw new Error("用户名或邮箱已存在");const o={id:Date.now(),username:e.username,email:e.email,nickname:e.nickname,role:"user",avatar:"",createdAt:(new Date).toISOString()};return t.push(o),localStorage.setItem("simulatedUsers",JSON.stringify(t)),o},f=()=>{t.value=null,e.value=null,a.value=!1,localStorage.removeItem("token"),localStorage.removeItem("userInfo"),l.nk.success("已退出登录")},p=async()=>{if(t.value)try{const t=await d.getUserInfo();e.value=t.data,localStorage.setItem("userInfo",JSON.stringify(t.data))}catch(a){console.error("获取用户信息失败:",a),f()}},h=async t=>{o.value=!0;try{const a=await d.updateUserInfo(t);return e.value={...e.value,...a.data},localStorage.setItem("userInfo",JSON.stringify(e.value)),l.nk.success("用户信息更新成功"),{success:!0}}catch(a){return l.nk.error(a.response?.data?.message||"更新失败，请重试"),{success:!1,error:a}}finally{o.value=!1}},k=()=>{if(t.value){const t=localStorage.getItem("userInfo");if(t)try{e.value=JSON.parse(t)}catch(a){console.error("解析用户信息失败:",a),f()}else p()}};return{userInfo:e,token:t,isLoggedIn:a,loading:o,username:i,avatar:s,userId:u,login:c,register:v,logout:f,fetchUserInfo:p,updateUserInfo:h,initUserState:k}})},8105:function(e,t,a){a.r(t),a.d(t,{useAppStore:function(){return l}});a(8111),a(2489),a(116),a(7588);var o=a(2261),r=a(6768),n=a(144);const l=(0,o.nY)("app",()=>{const e=(0,n.KR)(localStorage.getItem("theme")||"light"),t=(0,n.KR)(localStorage.getItem("language")||"zh-CN"),a=(0,n.KR)(!1),o=(0,n.KR)([]),l=(0,n.KR)(!1),i=(0,n.KR)("加载中..."),s=(0,n.KR)(null),u=(0,n.KR)(!1),c=(0,n.KR)({width:window.innerWidth,height:window.innerHeight}),d=(0,r.EW)(()=>"dark"===e.value),g=(0,r.EW)(()=>o.value.length),v=(0,r.EW)(()=>o.value.filter(e=>!e.read).length),m=t=>{e.value=t,localStorage.setItem("theme",t),document.documentElement.setAttribute("data-theme",t),window.dispatchEvent(new CustomEvent("theme-change",{detail:t}))},f=()=>{const t="light"===e.value?"dark":"light";m(t)},p=e=>{t.value=e,localStorage.setItem("language",e),window.dispatchEvent(new CustomEvent("language-change",{detail:e}))},h=()=>{a.value=!a.value},k=e=>{a.value=e},w=e=>{const t=Date.now()+Math.random(),a={id:t,read:!1,timestamp:(new Date).toISOString(),...e};return o.value.unshift(a),o.value.length>50&&(o.value=o.value.slice(0,50)),t},b=e=>{const t=o.value.findIndex(t=>t.id===e);t>-1&&o.value.splice(t,1)},S=e=>{const t=o.value.find(t=>t.id===e);t&&(t.read=!0)},y=()=>{o.value.forEach(e=>e.read=!0)},F=()=>{o.value=[]},_=(e="加载中...")=>{l.value=!0,i.value=e},L=()=>{l.value=!1,i.value="加载中..."},C=e=>{s.value={title:e.title||"错误",message:e.message||"发生未知错误",type:e.type||"error",timestamp:(new Date).toISOString()}},E=()=>{s.value=null},R=()=>{c.value={width:window.innerWidth,height:window.innerHeight},u.value=window.innerWidth<=768},I=()=>{R()},A=()=>{document.documentElement.setAttribute("data-theme",e.value),R(),window.addEventListener("resize",I),W()},M=()=>{try{localStorage.setItem("notifications",JSON.stringify(o.value))}catch(s){console.error("保存通知失败:",s)}},W=()=>{try{const e=localStorage.getItem("notifications");e&&(o.value=JSON.parse(e))}catch(s){console.error("加载通知失败:",s)}},K=()=>{window.removeEventListener("resize",I)};return{theme:e,language:t,sidebarCollapsed:a,notifications:o,loading:l,loadingText:i,isMobile:u,windowSize:c,isDarkMode:d,notificationCount:g,unreadNotificationCount:v,setTheme:m,toggleTheme:f,setLanguage:p,toggleSidebar:h,setSidebarCollapsed:k,addNotification:w,removeNotification:b,markNotificationAsRead:S,markAllNotificationsAsRead:y,clearNotifications:F,saveNotificationsToStorage:M,loadNotificationsFromStorage:W,showLoading:_,hideLoading:L,error:s,setError:C,clearError:E,updateWindowSize:R,init:A,cleanup:K}})}},t={};function a(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,o,r,n){if(!o){var l=1/0;for(c=0;c<e.length;c++){o=e[c][0],r=e[c][1],n=e[c][2];for(var i=!0,s=0;s<o.length;s++)(!1&n||l>=n)&&Object.keys(a.O).every(function(e){return a.O[e](o[s])})?o.splice(s--,1):(i=!1,n<l&&(l=n));if(i){e.splice(c--,1);var u=r();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[o,r,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce(function(t,o){return a.f[o](e,t),t},[]))}}(),function(){a.u=function(e){return"static/js/"+e+"."+{31:"7b605e07",52:"1d7b5e05",84:"7a60c007",173:"4cdd7e57",295:"13f8fe21",620:"8aec647f",705:"941da680",728:"eef4892f",790:"100f5da2",794:"1e416b54",925:"29a33191"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"static/css/"+e+"."+{31:"979471cb",52:"48e7566e",84:"78cf147a",173:"199c7761",295:"b6a8fbdd",705:"76a1d196",728:"2e60fc8e",790:"afd2fe4e",794:"ef30cb43",925:"aa5175c0"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="swift-share:";a.l=function(o,r,n,l){if(e[o])e[o].push(r);else{var i,s;if(void 0!==n)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+n){i=d;break}}i||(s=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+n),i.src=o),e[o]=[r];var g=function(t,a){i.onerror=i.onload=null,clearTimeout(v);var r=e[o];if(delete e[o],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach(function(e){return e(a)}),t)return t(a)},v=setTimeout(g.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=g.bind(null,i.onerror),i.onload=g.bind(null,i.onload),s&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/swift-share/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,r,n){var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",a.nc&&(l.nonce=a.nc);var i=function(a){if(l.onerror=l.onload=null,"load"===a.type)r();else{var o=a&&a.type,i=a&&a.target&&a.target.href||t,s=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+i+")");s.name="ChunkLoadError",s.code="CSS_CHUNK_LOAD_FAILED",s.type=o,s.request=i,l.parentNode&&l.parentNode.removeChild(l),n(s)}};return l.onerror=l.onload=i,l.href=t,o?o.parentNode.insertBefore(l,o.nextSibling):document.head.appendChild(l),l},t=function(e,t){for(var a=document.getElementsByTagName("link"),o=0;o<a.length;o++){var r=a[o],n=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(n===e||n===t))return r}var l=document.getElementsByTagName("style");for(o=0;o<l.length;o++){r=l[o],n=r.getAttribute("data-href");if(n===e||n===t)return r}},o=function(o){return new Promise(function(r,n){var l=a.miniCssF(o),i=a.p+l;if(t(l,i))return r();e(o,i,null,r,n)})},r={524:0};a.f.miniCss=function(e,t){var a={31:1,52:1,84:1,173:1,295:1,705:1,728:1,790:1,794:1,925:1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=o(e).then(function(){r[e]=0},function(t){throw delete r[e],t}))}}}(),function(){var e={524:0};a.f.j=function(t,o){var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)o.push(r[2]);else{var n=new Promise(function(a,o){r=e[t]=[a,o]});o.push(r[2]=n);var l=a.p+a.u(t),i=new Error,s=function(o){if(a.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var n=o&&("load"===o.type?"missing":o.type),l=o&&o.target&&o.target.src;i.message="Loading chunk "+t+" failed.\n("+n+": "+l+")",i.name="ChunkLoadError",i.type=n,i.request=l,r[1](i)}};a.l(l,s,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,n,l=o[0],i=o[1],s=o[2],u=0;if(l.some(function(t){return 0!==e[t]})){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(s)var c=s(a)}for(t&&t(o);u<l.length;u++)n=l[u],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},o=self["webpackChunkswift_share"]=self["webpackChunkswift_share"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],function(){return a(19)});o=a.O(o)})();